<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>HANIUM</title>
  <!-- Tell the browser to be responsive to screen width -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="/plugins/font-awesome/css/font-awesome.min.css">
  <!-- Ionicons -->
  <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">

  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.css">

  <!-- Theme style -->
  <link rel="stylesheet" href="/dist/css/adminlte.min.css">
  <!-- iCheck -->
  <link rel="stylesheet" href="/plugins/iCheck/flat/blue.css">
  <!-- Google Font: Source Sans Pro -->
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet">

</head>
<body class="hold-transition sidebar-mini">
<div class="wrapper">

  <!--nav + search + side-->
  <% include ./plain.ejs %>

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <div class="content-header">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6">
            <h1 class="m-0 text-dark">친구 관리</h1>
          </div><!-- /.col -->
        </div><!-- /.row -->
      </div><!-- /.container-fluid -->
    </div>
    <!-- /.content-header -->

    <!-- Main content -->
    <section class="content">
      <div class="container-fluid">

        <!-- friends list -->
        <div class="row">
          <div class="col-sm-12">
            <!-- Custom Tabs -->
            <div class="card">
              <div class="card-header d-flex p-0">
                <ul class="nav nav-pills mr-auto p-2">
                  <li class="nav-item"><a class="nav-link active" href="#tab_1" data-toggle="tab">즐겨찾기</a></li>
                  <li class="nav-item"><a class="nav-link" href="#tab_2" data-toggle="tab">그룹</a></li>
                </ul>
                
              </div><!-- /.card-header -->
              <div class="card-body">
                <div class="tab-content">
                  <div class="tab-pane active" id="tab_1">
                    <!-- Search friends -->
                    <div class="row">
                      <div class="col-sm-12 table-responsive">
                        <!-- 즐겨찾는 계정 리스트 -->
                        <table id="favoriteTable" class="table table-striped table-bordered" cellspacing="0" width="100%">
                          <thead>
                              <tr>
                                  <th>userid</th>
                                  <th>username</th>
                                  <th>comname</th>
                                  <th>department</th>
                                  <th>position</th>
                              </tr>
                          </thead>
                        </table>
                      </div>
                    </div>
                    <div  class="float-right">
                      <!-- 친구 추가 버튼 -->
                      <button type="button" class="btn btn-info btn-primary m-2" id="inputParticipant" data-toggle="modal" data-target="#addfavoriteModal">친구추가</button>
                      <!-- 즐겨찾는 계정 삭제 버튼 -->
                      <button type="submit" formaction="/meet/process" class="btn btn-primary">친구삭제</button>
                    </div>
                  </div>

                  <!-- /.tab-pane -->
                  <div class="tab-pane" id="tab_2">
                    <!-- Search group -->
                    <div class="row">
                      <div class="col-sm-12 table-responsive">
                        <!-- 그룹 리스트 -->
                        <table id="groupTable" class="table table-striped table-bordered" cellspacing="0" width="100%">
                          <thead>
                              <tr>
                                  <th>gnum</th> 
                                  <th>groupname</th> <!--그룹이름-->
                                  <th>username</th> <!--그룹개설자-->
                              </tr>
                          </thead>
                        </table>
                      </div>
                    </div>
                    <div  class="float-right">
                      <!-- 그룹 추가 버튼 -->
                      <button type="button" class="btn btn-info btn-primary m-2" id="inputParticipant" data-toggle="modal" data-target="#addgroupModal">그룹추가</button>
                      <!-- 그룹 삭제 버튼 -->
                      <button type="submit" formaction="/meet/process" class="btn btn-primary">그룹삭제</button>
                    </div>
                  </div>
                </div>
                <!-- /.tab-content -->
              </div><!-- /.card-body -->
            </div>
            <!-- ./card -->
          </div>
          <!-- /.col -->
        </div>
        <!-- /.row -->
        <!-- END CUSTOM TABS -->
        </div>

      </div><!-- /.container-fluid -->
    </section>
    <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->

  <!--footer-->
  <% include ./footer.ejs %>

  <!-- Control Sidebar -->
  <aside class="control-sidebar control-sidebar-dark">
    <!-- Control sidebar content goes here -->
  </aside>
  <!-- /.control-sidebar -->
</div>
<!-- ./wrapper -->

<!-- 이곳은 수정예정입니다 -->
<!-- add favorite Modal -->
<div id="addfavoriteModal" class="modal fade"  role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">새로운 친구 찾기</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-12 table-responsive">
            <table id="addTable" class="table table-striped table-bordered" style="display: table-header-group;" cellspacing="0" width="100%">
              <thead>
                  <tr>
                      <th>userid</th>
                      <th>username</th>
                      <th>comname</th>
                      <th>department</th>
                      <th>position</th>
                  </tr>
              </thead>
              <tfoot>
                  <tr>
                      <th>userid</th>
                      <th>username</th>
                      <th>comname</th>
                      <th>department</th>
                      <th>position</th>
                  </tr>
              </tfoot>
            </table>
          </div>
        </div>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal" id="modal-submit">추가</button>
      </div>
    </div>

  </div>
</div>

<!-- add group Modal -->
<div id="addgroupModal" class="modal fade"  role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">새로운 그룹 추가</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-12 table-responsive">
            <form action="/group/add" method="post">
              <div class="form-group has-feedback">
                <label for="gname">Group name: </label>
                <input type="text" class="form-control" placeholder="그룹명을 입력해주세요" name="groupname" id="gname">
              </div>
              <p>참여할 친구를 선택해주세요</p>
              <table id="favoriteTable2" class="table table-striped table-bordered" style="display: table-header-group;" cellspacing="0" width="100%">
                <thead>
                    <tr>
                        <th>userid</th>
                        <th>username</th>
                        <th>comname</th>
                        <th>department</th>
                        <th>position</th>
                    </tr>
                </thead>
              </table>
              <button type="submit" class="btn btn-default" data-dismiss="modal" id="group-modal-submit">추가</button>
            </form>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- jQuery -->
<script src="/plugins/jquery/jquery.min.js"></script>
<!-- jQuery UI 1.11.4 -->
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
<!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
<script>
  $.widget.bridge('uibutton', $.ui.button)
</script>
<!-- Bootstrap 4 -->
<script src="/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="/plugins/bootstrap/js/bootstrap.min.js"></script>
<!-- Sparkline -->
<script src="/plugins/sparkline/jquery.sparkline.min.js"></script>
<!-- Slimscroll -->
<script src="/plugins/slimScroll/jquery.slimscroll.min.js"></script>
<!-- FastClick -->
<script src="/plugins/fastclick/fastclick.js"></script>
<!-- AdminLTE App -->
<script src="/dist/js/adminlte.js"></script>
<!-- AdminLTE for demo purposes -->
<script src="/dist/js/demo.js"></script>
<!-- 활성화 시, 모달창 작동 에러
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
-->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.js"></script>

<script type="text/javascript">
$(document).ready(function() {

    $('a[data-toggle="tab"]').on( 'shown.bs.tab', function (e) { //탭이 보여지고 난 후
        $.fn.dataTable.tables( {visible: true, api: true} ).columns.adjust(); 
    } );
     
    //즐겨찾기 테이블
    $('#favoriteTable').DataTable( { 
        "ajax": {
          "url": '/favorite/find', 
          "dataSrc" : "", 
        }, 
        "columns": [
          { "data": "userid" }, 
          { "data": "username" }, 
          { "data": "comname" }, 
          { "data": "department" },
          { "data": "position" }
        ],
        "scrollY":        200,
        "scrollCollapse": true,
        "paging":         false
    });

    //그룹 테이블
    $('#groupTable').DataTable( {
        "ajax": {
          "url": '/group/find/query', 
          "dataSrc" : "", 
        }, 
        "columns": [
          { "data": "gnum" }, 
          { "data": "groupname" }, 
          { "data": "username" }
        ],
        "scrollY":        200,
        "scrollCollapse": true,
        "paging":         false
    });

    //그룹추가-참여자 선택을 위한 친구 테이블
    var table2 = $('#favoriteTable2').DataTable( { 
        "ajax": {
          "url": '/favorite/find', 
          "dataSrc" : "", 
        }, 
        "columns": [
          { "data": "userid" }, 
          { "data": "username" }, 
          { "data": "comname" }, 
          { "data": "department" },
          { "data": "position" }
        ],
        "scrollY":        200,
        "scrollCollapse": true,
        "paging":         false
    });
    //선택한 행
    $('#favoriteTable2 tbody').on( 'click', 'tr', function () {
        $(this).toggleClass('selected');
    } );
    //'추가'버튼 클릭시 서버로 전달되는 data (member)
    $('#group-modal-submit').click( function () {
        var member = table2.rows('.selected').data();
        alert(
          "다음의 데이터가 서버에 제출되었습니다: \n\n"+member.substr(0, 120)+'...'
          );
        return false;
    } );

    // 수정 예정 
    // Setup - add a text input to each footer cell
    $('#addTable tfoot th').each( function () {
        var title = $(this).text();
        $(this).html( '<input type="text" placeholder="Search '+title+'" />' );
    } );
    // 친구 추가 DataTable
    var table = $('#addTable').DataTable( {
        ajax:           '/add/find', //ajax url
        scrollY:        200,
        scrollCollapse: true,
        paging:         false
    });
    // Apply the search
    table.columns().every( function () {
        var that = this;
 
        $( 'input', this.footer() ).on( 'keyup change', function () {
            if ( that.search() !== this.value ) {
                that
                    .search( this.value )
                    .draw();
            }
        } );
    } );
    $('#addTable tfoot tr').appendTo('#addTable thead');

});


</script>
<script src="/dist/js/multiselect.js"></script>
</body>
</html>
